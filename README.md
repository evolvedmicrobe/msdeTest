Development version of msde

The C++ code is rewritten with OOP but somewhat slower than original (stable) version.
